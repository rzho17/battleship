(()=>{"use strict";const e=class{constructor(e,t,o,r){this.length=e,this.hits=t,this.sunk=o,this.name=r}isHit(){return this.hits+=1}isSunk(){return this.hits===this.length&&(this.sunk=!0)}},t=e=>{let t=0;for(let o=0;o<10;o++){for(let o=0;o<10;o++){const r=document.createElement("div");e.appendChild(r),r.className="gridSquare",r.dataset.gridPosition=`${t}${o}`}t++}},o=(e,t,o)=>{e.placeShip(e.shipHolder.shift(),t,o),h(e.gameBoard.board,"initialBoard"),e.shipHolder.length<1&&n(e)},r=(e,t,o)=>{const r=e.shipHolder[0];let a=t.dataset.gridPosition[0],n=t.dataset.gridPosition[1];for(let e=0;e<r.length;e++){n=parseInt(n);let e=document.querySelector(`.initialBoard [data-grid-position="${a}${n}"]`);e.classList.contains("ship")?e.style.backgroundColor="red":e.style.backgroundColor=o,10-r.length<t.dataset.gridPosition[1]||(n+=1),t.addEventListener("mouseout",(()=>{document.querySelectorAll(" .ship").forEach((e=>{e.style.backgroundColor="orange"}))}))}},a=(e,t,o)=>{const r=e.shipHolder[0];let a=t.dataset.gridPosition[0],n=t.dataset.gridPosition[1];for(let e=0;e<r.length;e++){a=parseInt(a);let e=document.querySelector(`.initialBoard [data-grid-position="${a}${n}"]`);e.classList.contains("ship")?e.style.backgroundColor="red":e.style.backgroundColor=o,10-r.length<t.dataset.gridPosition[0]||(a+=1),t.addEventListener("mouseout",(()=>{document.querySelectorAll(" .ship").forEach((e=>{e.style.backgroundColor="orange"}))}))}},n=e=>{document.querySelector(".loadContainer").style.display="none",h(e.gameBoard.board,"playerBoard")},i=e=>{const t=document.querySelector(".displayShip");e.shipHolder.length>0&&(t.innerText=`Place your: ${e.shipHolder[0].name}`)},l=e=>{const n=document.querySelector("main"),l=document.createElement("div");l.className="loadContainer";const s=document.createElement("div");s.className="loadInfo";const d=document.createElement("h2");d.className="loadTitle",d.innerText="Let's play Battleship!";const h=document.createElement("div");h.className="displayShip",h.innerText=`Place your: ${e.shipHolder[0].name}`;const u=document.createElement("button");u.className="rotateBtn",u.innerText="Rotate Ship";const p=document.createElement("div");p.className="gameBoard initialBoard",t(p),s.append(d,h,u,p),l.append(s),n.append(l),(e=>{const t=document.querySelectorAll(".initialBoard .gridSquare"),n=document.querySelector(".rotateBtn");let l="x";n.addEventListener("click",(()=>{l=(e=>"x"===e?"y":"x")(l)})),t.forEach((t=>{t.addEventListener("click",(t=>{if(e.shipHolder.length>0){const r=c(t.target.dataset.gridPosition),a=e.shipHolder[0],n=10-a.length>=r[1],s=10-a.length>=r[0],d=!1===e.gameBoard.checkShip(a,r,l);"x"===l&&n&&d&&(o(e,r,l),i(e)),"y"===l&&s&&d&&(o(e,r,l),i(e))}})),t.addEventListener("mouseover",(()=>{e.shipHolder.length>0&&((e,t,o)=>{"x"===t&&r(e,o,"blue"),"y"===t&&a(e,o,"blue")})(e,l,t)})),t.addEventListener("mouseout",(()=>{e.shipHolder.length>0&&((e,t,o)=>{"x"===t&&r(e,o,"white"),"y"===t&&a(e,o,"white")})(e,l,t)}))}))})(e)},s=e=>{document.querySelector(".loadContainer").style.display="flex";const t=document.querySelector(".loadInfo");t.innerHTML="";const o=document.createElement("h2");o.innerText=e,o.className="loadTitle";const r=document.createElement("button");r.innerText="Play Again?",r.className="playAgainBtn",t.append(o,r)},c=e=>[parseInt(e[0]),parseInt(e[1])],d=(e,t,o,r)=>{const a=document.querySelector(`.${r} [data-grid-position="${e}${t}"]`);a.classList.add("ship"),a.style.backgroundColor=o},h=(t,o)=>{for(let r=0;r<t.length;r++)for(let a=0;a<t[r].length;a++)"initialBoard"===o||"playerBoard"===o?(t[r][a]instanceof e&&d([r],[a],"orange",o),"x"===t[r][a]?d([r],[a],"red",o):"o"===t[r][a]&&d([r],[a],"grey",o)):"x"===t[r][a]?d([r],[a],"red",o):"o"===t[r][a]&&d([r],[a],"grey",o)},u=t,p=class{constructor(){this.board=this.createBoard()}createBoard(){const e=[];for(let t=0;t<10;t++){const t=[];for(let e=0;e<10;e++)t.push(null);e.push(t)}return e}checkShip(t,o,r){const a=o[0],n=o[1],i=10-t.length>=n,l=10-t.length>=a;let s=!1;if("x"===r&&i)for(let o=0;o<t.length;o++)this.board[a][n+o]instanceof e&&(s=!0);if("y"===r&&l)for(let o=0;o<t.length;o++)this.board[a+o][n]instanceof e&&(s=!0);return console.log(`i will place ${t.length} @ [${o}] Position ${r}`),s}placeShip(e,t,o){const r=t[0],a=t[1],n=10-e.length>=a,i=10-e.length>=r;if(!1===this.checkShip(e,t,o)){if("x"===o&&n)for(let t=0;t<e.length;t++)this.board[r][a+t]=e;if("y"===o&&i)for(let t=0;t<e.length;t++)this.board[r+t][a]=e}}receiveAttack(t){const o=t[0],r=t[1];let a=this.board[o][r];if(a instanceof e&&(a.isHit(),a.hits===a.length&&a.isSunk(),this.board[o][r]="x"),null===a&&(this.board[o][r]="o"),"x"===a)return"invalid move"}findValidPosition(e,t,o){const r=t[0],a=t[1],n=10-e.length>=a,i=10-e.length>=r;let l=!1;return("x"===o&&!n||"y"===o&&!i)&&(l=!0),l}allShipsSunk(){let t=!0;for(let o=0;o<this.board.length;o++)for(let r=0;r<this.board[o].length;r++)this.board[o][r]instanceof e&&(t=!1);return t}},m=class{constructor(t,o){this.gameBoard=new p,this.carrier=new e(5,0,!1,"Carrier"),this.battleship=new e(4,0,!1,"Battleship"),this.destroyer=new e(3,0,!1,"Destroyer"),this.submarine=new e(3,0,!1,"Submarine"),this.patrolBoat=new e(2,0,!1,"Patrol Boat"),this.shipHolder=[this.carrier,this.battleship,this.destroyer,this.submarine,this.patrolBoat]}placeShip(e,t,o){this.gameBoard.placeShip(e,t,o)}receiveAttack(e){this.gameBoard.receiveAttack(e)}computerAttack(){const e=Math.floor(10*Math.random()),t=Math.floor(10*Math.random());"o"===this.gameBoard.board[e][t]&&"x"===this.gameBoard.board[e][t]||this.receiveAttack([e,t])}},g={coordArr:[[0,0],[0,1],[0,2],[0,3],[0,4],[0,5],[0,6],[0,7],[0,8],[0,9],[1,0],[1,1],[1,2],[1,3],[1,4],[1,5],[1,6],[1,7],[1,8],[1,9],[2,0],[2,1],[2,2],[2,3],[2,4],[2,5],[2,6],[2,7],[2,8],[2,9],[3,0],[3,1],[3,2],[3,3],[3,4],[3,5],[3,6],[3,7],[3,8],[3,9],[4,0],[4,1],[4,2],[4,3],[4,4],[4,5],[4,6],[4,7],[4,8],[4,9],[5,0],[5,1],[5,2],[5,3],[5,4],[5,5],[5,6],[5,7],[5,8],[5,9],[6,0],[6,1],[6,2],[6,3],[6,4],[6,5],[6,6],[6,7],[6,8],[6,9],[7,0],[7,1],[7,2],[7,3],[7,4],[7,5],[7,6],[7,7],[7,8],[7,9],[8,0],[8,1],[8,2],[8,3],[8,4],[8,5],[8,6],[8,7],[8,8],[8,9],[9,0],[9,1],[9,2],[9,3],[9,4],[9,5],[9,6],[9,7],[9,8],[9,9]],coordArrAtt:[[0,0],[0,1],[0,2],[0,3],[0,4],[0,5],[0,6],[0,7],[0,8],[0,9],[1,0],[1,1],[1,2],[1,3],[1,4],[1,5],[1,6],[1,7],[1,8],[1,9],[2,0],[2,1],[2,2],[2,3],[2,4],[2,5],[2,6],[2,7],[2,8],[2,9],[3,0],[3,1],[3,2],[3,3],[3,4],[3,5],[3,6],[3,7],[3,8],[3,9],[4,0],[4,1],[4,2],[4,3],[4,4],[4,5],[4,6],[4,7],[4,8],[4,9],[5,0],[5,1],[5,2],[5,3],[5,4],[5,5],[5,6],[5,7],[5,8],[5,9],[6,0],[6,1],[6,2],[6,3],[6,4],[6,5],[6,6],[6,7],[6,8],[6,9],[7,0],[7,1],[7,2],[7,3],[7,4],[7,5],[7,6],[7,7],[7,8],[7,9],[8,0],[8,1],[8,2],[8,3],[8,4],[8,5],[8,6],[8,7],[8,8],[8,9],[9,0],[9,1],[9,2],[9,3],[9,4],[9,5],[9,6],[9,7],[9,8],[9,9]]},y=()=>(!0===S.computer.gameBoard.allShipsSunk()&&(s("player win"),f()),!0===S.player.gameBoard.allShipsSunk()&&(s("computer win"),f()),console.log("nno winner yet")),f=()=>{const e=document.querySelector(".playAgainBtn"),t=document.querySelector(".loadContainer"),o=new m,r=new m,a=[[0,0],[0,1],[0,2],[0,3],[0,4],[0,5],[0,6],[0,7],[0,8],[0,9],[1,0],[1,1],[1,2],[1,3],[1,4],[1,5],[1,6],[1,7],[1,8],[1,9],[2,0],[2,1],[2,2],[2,3],[2,4],[2,5],[2,6],[2,7],[2,8],[2,9],[3,0],[3,1],[3,2],[3,3],[3,4],[3,5],[3,6],[3,7],[3,8],[3,9],[4,0],[4,1],[4,2],[4,3],[4,4],[4,5],[4,6],[4,7],[4,8],[4,9],[5,0],[5,1],[5,2],[5,3],[5,4],[5,5],[5,6],[5,7],[5,8],[5,9],[6,0],[6,1],[6,2],[6,3],[6,4],[6,5],[6,6],[6,7],[6,8],[6,9],[7,0],[7,1],[7,2],[7,3],[7,4],[7,5],[7,6],[7,7],[7,8],[7,9],[8,0],[8,1],[8,2],[8,3],[8,4],[8,5],[8,6],[8,7],[8,8],[8,9],[9,0],[9,1],[9,2],[9,3],[9,4],[9,5],[9,6],[9,7],[9,8],[9,9]];e.addEventListener("click",(()=>{t.remove(),S.player=o,S.computer=r,g.coordArr=[...a],g.coordArrAtt=[...a],console.log(S.player.gameBoard.board),l(S.player),B()}))},S={player:new m,computer:new m},B=()=>{var t,o;(()=>{const e=document.querySelector(".playerBoard"),t=document.querySelector(".computerBoard");e.innerHTML="",t.innerHTML="",u(e),u(t)})(),(()=>{for(;S.computer.shipHolder.length>0;){const t=S.computer.shipHolder[0],o=(e=void 0,(e=Math.floor(Math.random()*g.coordArr.length),g.coordArr.splice(e,1)).flat(1)),r=1===Math.floor(2*Math.random())?"x":"y";!1===S.computer.gameBoard.checkShip(t,o,r)&&!1===S.computer.gameBoard.findValidPosition(t,o,r)&&(S.computer.placeShip(t,o,r),S.computer.shipHolder.shift())}var e})(),document.querySelectorAll(".computerBoard .gridSquare ").forEach((e=>{e.addEventListener("click",(e=>{const t=c(e.target.dataset.gridPosition);e.target.classList.contains("ship")||(S.computer.receiveAttack(t),console.log(g.coordArr),setTimeout((()=>{var e;S.player.receiveAttack((e=Math.floor(Math.random()*g.coordArrAtt.length),g.coordArrAtt.splice(e,1)).flat(1)),h(S.player.gameBoard.board,"playerBoard"),y()}),150),y())}))})),t=S.computer.gameBoard.board,o="computerBoard",document.querySelectorAll(`.${o} .gridSquare`).forEach((r=>{r.addEventListener("click",(r=>{const a=c(r.target.dataset.gridPosition),n=a[0],i=a[1];t[n][i]instanceof e&&(r.target.style.backgroundColor="orange"),null===t[n][i]&&(r.target.style.backgroundColor="grey"),h(t,o)}))}))},b=B;l(S.player),b()})();